<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Predicci贸n de Riesgo Cardiaco</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Fuente Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#f3f7fb;
      --panel:#ffffff;
      --text:#334155;
      --muted:#64748b;
      --brand:#00bcd4;
      --brand-dark:#0097a7;
      --danger:#e53935;
      --radius:16px;
      --shadow:0 5px 15px rgba(0,0,0,0.1);
    }
    *{ box-sizing:border-box; }
    html,body{
      margin:0;padding:0;
      font-family:'Poppins', sans-serif;
      background:linear-gradient(135deg,#e1f5fe,#f3f7fb);
      color:var(--text);
      min-height:100vh;
    }
    .container{max-width:960px;margin:40px auto;padding:0 16px;}
    .card{
      background:var(--panel);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:30px;
      border:1px solid #e2e8f0;
    }
    h1{
      margin:0 0 12px;
      font-size:clamp(24px,3.4vw,34px);
      color:#0f324a;
      font-weight:600;
    }
    .sub{margin:0 0 20px;font-size:14px;color:var(--muted);}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px;}
    .field{
      grid-column:span 12;
      background:#f8fafc;
      border-radius:12px;
      border:1px solid #e2e8f0;
      padding:10px 12px 6px;
      display:flex;flex-direction:column;
      transition:all .2s;
    }
    .field:focus-within{
      border-color:var(--brand);
      box-shadow:0 0 6px rgba(0,188,212,0.35);
      background:#e0f7fa;
    }
    .label{font-size:12px;color:var(--muted);margin-bottom:4px;}
    input,select{
      background:transparent;border:none;outline:none;
      color:var(--text);font-size:14px;padding:4px 2px 6px;
    }
    .radios{display:flex;gap:16px;font-size:13px;margin-top:4px;}
    option{color:#020617;}
    @media (min-width:640px){
      .field--half{grid-column:span 6;}
      .field--third{grid-column:span 4;}
    }
    .actions{margin-top:24px;display:flex;gap:14px;flex-wrap:wrap;}
    .btn{
      border:none;border-radius:30px;padding:13px 22px;
      font-size:15px;font-weight:600;cursor:pointer;
      background:linear-gradient(135deg,var(--brand),var(--brand-dark));
      color:white;transition:all .2s;
      box-shadow:0 6px 14px rgba(0,188,212,0.25);
    }
    .btn:hover{transform:translateY(-2px) scale(1.02);}
    .btn:active{transform:scale(.98);}
    .result,.error{
      margin-top:20px;border-radius:14px;padding:14px 16px;font-size:14px;
      border:1px solid rgba(0,0,0,0.05);
    }
    .btn-volver {
      background: linear-gradient(135deg, #161414, #3b2426);
      box-shadow: 0 6px 14px rgba(255, 107, 107, 0.3);
    }
    .btn-volver:hover {
      transform: translateY(-2px) scale(1.02);
    }
    .btn-volver:active {
      transform: scale(.98);
    }
    .result{background:#e0f7fa;color:#006064;}
    .error{background:#ffebee;color:#c62828;}
    .helper{margin-top:6px;font-size:12px;color:var(--muted);}
    .footer{margin-top:14px;font-size:12px;color:var(--muted);text-align:center;opacity:.75;}
  </style>
</head>
<body>

  <div class="container">
    <div class="card">
      <h1>Predicci贸n de riesgo cardiaco</h1>
      <p class="sub">
        Llena los datos del paciente y presiona <b>Calcular</b>.  
        Se permite punto o coma como separador decimal.
      </p>

      <form action="/predict" method="post" novalidate>
        <div class="grid">
          <!-- Campos num茅ricos -->
          <div class="field field--third">
            <span class="label">Edad (a帽os)</span>
            <input type="text" name="edad" placeholder="Rango: 0 a 100"
              value="{{ (last_values or {}).get('edad','') }}" required>
          </div>

          <div class="field field--third">
            <span class="label">Presi贸n arterial reposo (mmHg)</span>
            <input type="text" name="trestbps" placeholder="Rango: 80 a 200"
              value="{{ (last_values or {}).get('trestbps','') }}" required>
          </div>

          <div class="field field--third">
            <span class="label">Colesterol s茅rico (mg/dl)</span>
            <input type="text" name="chol" placeholder="Rango: 100 a 600"
              value="{{ (last_values or {}).get('chol','') }}" required>
          </div>

          <div class="field field--third">
            <span class="label">Frecuencia cardiaca m谩x.</span>
            <input type="text" name="thalach" placeholder="Rango: 60 a 220"
              value="{{ (last_values or {}).get('thalach','') }}" required>
          </div>

          <div class="field field--third">
            <span class="label">Depresi贸n ST (oldpeak)</span>
            <input type="text" name="oldpeak" placeholder="Rango: 0.0 a 6.0"
              value="{{ (last_values or {}).get('oldpeak','') }}" required>
          </div>

          <div class="field field--third">
            <span class="label">Glucosa en ayunas (>120 mg/dl)</span>
            <select name="fbs" required>
              <option value="" disabled selected hidden>0 = No 路 1 = S铆</option>
              <option value="1" {% if (last_values or {}).get('fbs') == '1' %}selected{% endif %}>S铆</option>
              <option value="0" {% if (last_values or {}).get('fbs') == '0' %}selected{% endif %}>No</option>
            </select>
          </div>

          <!-- Campos categ贸ricos -->
          <div class="field field--half">
            <span class="label">Sexo</span>
            <div class="radios">
              <label><input type="radio" name="sexo" value="male"
                {% if (last_values or {}).get('sexo') == 'male' %}checked{% endif %}> Hombre</label>
              <label><input type="radio" name="sexo" value="female"
                {% if (last_values or {}).get('sexo') == 'female' %}checked{% endif %}> Mujer</label>
            </div>
          </div>

          <div class="field field--half">
            <span class="label">Tipo de dolor en el pecho</span>
            <select name="cp" required>
              <option value="" disabled selected hidden>Selecciona</option>
              <option value="typical angina">Angina t铆pica</option>
              <option value="atypical angina">Angina at铆pica</option>
              <option value="non-anginal pain">Dolor no anginoso</option>
              <option value="asymptomatic">Asintom谩tico</option>
            </select>
          </div>

          <div class="field field--half">
            <span class="label">ECG en reposo</span>
            <select name="restecg" required>
              <option value="" disabled selected hidden>Selecciona</option>
              <option value="0">Normal</option>
              <option value="1">ST-T alterado</option>
              <option value="2">Hipertrofia</option>
            </select>
          </div>

          <div class="field field--half">
            <span class="label">Angina por ejercicio</span>
            <select name="exang" required>
              <option value="" disabled selected hidden>Selecciona</option>
              <option value="1">S铆</option>
              <option value="0">No</option>
            </select>
          </div>

          <div class="field field--half">
            <span class="label">Pendiente ST</span>
            <select name="slope" required>
              <option value="" disabled selected hidden>Selecciona</option>
              <option value="1">Ascendente</option>
              <option value="2">Plana</option>
              <option value="3">Descendente</option>
            </select>
          </div>

          <div class="field field--half">
            <span class="label">N.潞 de vasos coloreados</span>
            <select name="ca" required>
              <option value="" disabled selected hidden>Selecciona</option>
              <option value="0.0">0</option>
              <option value="1.0">1</option>
              <option value="2.0">2</option>
              <option value="3.0">3</option>
            </select>
          </div>

          <div class="field field--half">
            <span class="label">Thal</span>
            <select name="thal" required>
              <option value="" disabled selected hidden>Selecciona</option>
              <option value="3.0">Normal</option>
              <option value="6.0">Defecto fijo</option>
              <option value="7.0">Defecto reversible</option>
            </select>
          </div>
        </div>

        <div class="actions">
          <button class="btn" type="submit">Calcular</button>
        </div>

        {% if prediction_text %}
        <div class="result">
          <strong>Resultado:</strong> {{ prediction_text }}
          <div class="helper">Este resultado no sustituye evaluaci贸n m茅dica profesional.</div>
        </div>
        {% if resumen %}
          <div class="result" style="margin-top:15px;">
            <strong> Datos ingresados:</strong>
            <ul>
              {% for key, value in resumen.items() %}
                <li><b>{{ key }}:</b> {{ value }}</li>
              {% endfor %}
            </ul>
          </div>
        
        {% endif %}
        <div class="actions" style="margin-top:15px;">
          <a href="/" class="btn btn-secondary btn-volver">Volver</a>
        </div>

        {% endif %}


        {% if error_text %}
        <div class="error">
          <strong>Error:</strong> {{ error_text }}
        </div>
        {% endif %}
      </form>

  

      <div class="footer">
        Aplicaci贸n con fines educativos | Flask + Modelo ML
      </div>
    </div>
  </div>

</body>
</html>
